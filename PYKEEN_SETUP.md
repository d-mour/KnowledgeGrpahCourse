# Использование PyKEEN для Knowledge Graph Embeddings

## Почему PyKEEN?

Текущая самописная реализация имеет проблемы:
- ❌ Loss растет вместо уменьшения
- ❌ Модель не различает связи
- ❌ Все score одинаковые

**PyKEEN** - это стандартная библиотека, упомянутая в лекции:
- ✅ Проверенная реализация
- ✅ Поддержка множества моделей (TransE, DistMult, ComplEx, RotatE и т.д.)
- ✅ Правильная оптимизация
- ✅ Метрики качества (MR, MRR, Hits@k)
- ✅ Используется в исследованиях

## Установка

```bash
# В виртуальном окружении
source venv/bin/activate
pip install pykeen
```

## Использование

### Создание embeddings:

```bash
# Базовое использование
python create_kg_embeddings_pykeen.py --epochs 100 --dim 64

# С другими моделями
python create_kg_embeddings_pykeen.py --model DistMult --epochs 100
python create_kg_embeddings_pykeen.py --model ComplEx --epochs 100
python create_kg_embeddings_pykeen.py --model RotatE --epochs 100
```

### Доступные модели:

- **TransE** - базовая модель (рекомендуется для начала)
- **DistMult** - для симметричных отношений
- **ComplEx** - для антисимметричных отношений
- **RotatE** - универсальная модель
- **TuckER** - более мощная модель

## Преимущества

1. **Правильная реализация** - проверена сообществом
2. **Автоматические метрики** - MR, MRR, Hits@k
3. **Разделение train/test** - правильная оценка качества
4. **Легкая загрузка** - можно загрузить обученную модель
5. **Поддержка GPU** - быстрее обучение

## Сравнение

| Параметр | Самописная | PyKEEN |
|----------|-----------|--------|
| Loss уменьшается | ❌ | ✅ |
| Правильные градиенты | ❌ | ✅ |
| Метрики качества | ❌ | ✅ |
| Поддержка моделей | 1 (TransE) | 20+ |
| Стабильность | ❌ | ✅ |

## Рекомендация

**Используйте PyKEEN** - это правильный подход для Knowledge Graph Embeddings.

