# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ Knowledge Graph Embeddings

## –ü–æ–ª–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyKEEN

```bash
source venv/bin/activate
pip install pykeen
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ embeddings

```bash
python create_kg_embeddings_pykeen.py --epochs 100 --dim 64
```

–≠—Ç–æ –∑–∞–π–º–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è (10-20 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞).

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —Ç—Ä–∏–ø–ª–µ—Ç—ã –∏–∑ –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π
- –°–æ–∑–¥–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å TransE
- –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏ —Å–≤—è–∑–µ–π
- –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (MR, MRR, Hits@k)
- –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è embeddings –∏ –º–æ–¥–µ–ª—å

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!
üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
   MR (Mean Rank): ...
   MRR: ...
   Hits@10: ...
‚úÖ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤: kg_embeddings_pykeen/
```

### –®–∞–≥ 3: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã

```bash
python test_pykeen_embeddings.py
```

**–ß—Ç–æ –ø–æ–∫–∞–∂–µ—Ç:**

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   - –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å embeddings
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π

2. **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è 1: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–≤—è–∑–µ–π (Link Prediction)**
   - –ü—Ä–∏–º–µ—Ä 1: "–ö—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —ç—Ç–æ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—å?"
     - –ó–∞–ø—Ä–æ—Å: `(BMW_3_Series_2016, MadeBy, ?)`
     - –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π —Å scores
   
   - –ü—Ä–∏–º–µ—Ä 2: "–ö–∞–∫–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç BMW?"
     - –ó–∞–ø—Ä–æ—Å: `(?, MadeBy, BMW)`
     - –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –æ—Ç BMW —Å scores

3. **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è 2: –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π**
   - –ù–∞—Ö–æ–¥–∏—Ç —Å—É—â–Ω–æ—Å—Ç–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ embeddings
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ

## –ß—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É?

### ‚úÖ –•–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

1. **Score –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Å–≤—è–∑–µ–π –≤—ã—à–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö:**
   ```
   –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å: score = 5.2
   –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å: score = -2.1
   ```

2. **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–∑—É–º–Ω—ã–µ:**
   - MR < 100 (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ)
   - MRR > 0.1 (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º –ª—É—á—à–µ)
   - Hits@10 > 0.1 (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º –ª—É—á—à–µ)

3. **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ª–æ–≥–∏—á–Ω—ã–µ:**
   - `(Vehicle, MadeBy, ?)` ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è
   - `(?, MadeBy, BMW)` ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –æ—Ç BMW

### ‚ùå –ü–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

1. –í—Å–µ score –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ
2. –ú–µ—Ç—Ä–∏–∫–∏ –æ—á–µ–Ω—å –ø–ª–æ—Ö–∏–µ (MR > 1000, MRR < 0.01)
3. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–µ–ª–æ–≥–∏—á–Ω—ã–µ (BMW ‚Üí Toyota)

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏

–ï—Å–ª–∏ TransE –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏:

```bash
# DistMult (–¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π)
python create_kg_embeddings_pykeen.py --model DistMult --epochs 100

# ComplEx (–¥–ª—è –∞–Ω—Ç–∏—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π)
python create_kg_embeddings_pykeen.py --model ComplEx --epochs 100

# RotatE (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è)
python create_kg_embeddings_pykeen.py --model RotatE --epochs 100
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –≤ —Å–≤–æ–µ–º –∫–æ–¥–µ:

```python
from pykeen.models import TransE
import torch

# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å
model = TransE.from_pretrained('kg_embeddings_pykeen')

# –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º tail –¥–ª—è (head, relation, ?)
head_ids = torch.tensor([0, 1, 2])  # ID —Å—É—â–Ω–æ—Å—Ç–µ–π
relation_ids = torch.tensor([0, 0, 0])  # ID –æ—Ç–Ω–æ—à–µ–Ω–∏—è
scores = model.score_hrt(head_ids, relation_ids, None)

# –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ø-10 –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
top_scores, top_indices = torch.topk(scores, k=10, dim=-1)
```

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –í—Å–µ –≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ
python create_kg_embeddings_pykeen.py --epochs 100 --dim 64 && python test_pykeen_embeddings.py
```

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–∏—Å–∫–∞
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. ‚úÖ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏
4. ‚úÖ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏ (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

